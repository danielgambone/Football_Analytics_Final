<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2024 NFL Team Scoring Analytics</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            padding: 30px;
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        label {
            font-weight: 600;
            color: #444;
            font-size: 1.1em;
        }

        select {
            padding: 10px 20px;
            font-size: 16px;
            border: 2px solid #667eea;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            min-width: 200px;
            transition: all 0.3s ease;
        }

        select:hover {
            border-color: #764ba2;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        select:focus {
            outline: none;
            border-color: #764ba2;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        }

        .chart-container {
            position: relative;
            height: 500px;
            margin-bottom: 30px;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
        }

        .stats-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .stat-card h3 {
            font-size: 0.9em;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .stat-card .value {
            font-size: 2.5em;
            font-weight: bold;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #667eea;
            font-size: 1.2em;
        }

        .error {
            text-align: center;
            padding: 40px;
            color: #dc3545;
            font-size: 1.1em;
        }

        canvas {
            max-height: 100%;
        }

        .top10-section {
            margin-top: 40px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #e5e7eb;
        }

        .top10-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 12px;
        }

        .top10-title {
            font-size: 1.4em;
            color: #333;
        }

        .legend-row {
            display: flex;
            gap: 16px;
            align-items: center;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #444;
            font-size: 0.95em;
        }

        .legend-swatch {
            width: 14px;
            height: 14px;
            border-radius: 3px;
        }

        .project-report {
            margin-top: 40px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #e5e7eb;
        }

        .project-report h2 {
            margin-bottom: 10px;
            color: #333;
        }

        .project-report h3,
        .project-report h4 {
            margin-top: 20px;
            margin-bottom: 8px;
            color: #444;
        }

        .project-report p {
            margin-bottom: 12px;
            line-height: 1.6;
            color: #333;
        }

        .project-report ul {
            margin: 10px 0 16px 20px;
            color: #333;
        }

        .project-report pre {
            background: #1e1e1e;
            color: #e5e5e5;
            padding: 12px;
            border-radius: 8px;
            overflow-x: auto;
            margin-bottom: 16px;
        }

        .project-report code {
            font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
        }

        .viz-section {
            margin-top: 40px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #e5e7eb;
        }

        .viz-section h2 {
            margin-bottom: 15px;
            color: #333;
            text-align: center;
        }

        .comparison-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèà NFL Team Scoring Analytics</h1>
        <p class="subtitle">2024 Regular Season Statistics</p>
        
        <div class="controls">
            <label for="teamSelect">Select Team:</label>
            <select id="teamSelect">
                <option value="">-- Choose a Team --</option>
            </select>
        </div>

        <div class="chart-container">
            <canvas id="scoringChart"></canvas>
        </div>

        <div class="stats-summary" id="statsSummary"></div>

        <!-- Offensive Balance Pie Chart -->
        <section class="viz-section" id="offensiveBalanceSection" style="display: none;">
            <h2>Offensive Balance: Rushing vs Receiving TDs</h2>
            <div class="chart-container" style="height: 400px;">
                <canvas id="pieChart"></canvas>
            </div>
        </section>

        <!-- Radar Chart -->
        <section class="viz-section" id="radarSection" style="display: none;">
            <h2>Team Profile</h2>
            <div class="chart-container" style="height: 450px;">
                <canvas id="radarChart"></canvas>
            </div>
        </section>

        <!-- Team Comparison -->
        <section class="viz-section">
            <h2>Team Comparison</h2>
            <div class="comparison-controls">
                <label for="team1Select">Team 1:</label>
                <select id="team1Select">
                    <option value="">-- Choose Team 1 --</option>
                </select>
                <label for="team2Select">Team 2:</label>
                <select id="team2Select">
                    <option value="">-- Choose Team 2 --</option>
                </select>
            </div>
            <div class="chart-container" style="height: 450px;">
                <canvas id="comparisonChart"></canvas>
            </div>
        </section>

        <!-- Scatter Plot -->
        <section class="viz-section">
            <h2>Wins vs Total Touchdowns Correlation</h2>
            <div class="controls" style="margin-bottom: 15px;">
                <label for="scatterTeamSelect">Highlight Team:</label>
                <select id="scatterTeamSelect">
                    <option value="">-- All Teams --</option>
                </select>
            </div>
            <div class="chart-container" style="height: 500px;">
                <canvas id="scatterChart"></canvas>
            </div>
        </section>

        <section class="top10-section">
            <div class="top10-header">
                <h2 class="top10-title">Top 10 Teams: Wins vs Total Touchdowns</h2>
                <div class="legend-row">
                    <div class="legend-item"><span class="legend-swatch" style="background:#667eea"></span>Wins (Win Rank)</div>
                    <div class="legend-item"><span class="legend-swatch" style="background:#f093fb"></span>Total TDs (TD Rank)</div>
                </div>
            </div>
            <div class="chart-container" style="height: 420px;">
                <canvas id="top10Chart"></canvas>
            </div>
        </section>

        <section class="project-report" id="project-report">
            <h2>Project Report</h2>

            <h3>Landing page</h3>
            <h4>Overview</h4>
            <p>I used the 2024 NFL regular season league standings statistics and the 2024 NFL team scoring statistics from the NFL website to create a web application that educates the user about a given team's success during the year with statistical proof. I hoped to show the correlation between team standings and scoring.</p>
            <p><a href="https://github.com/danielgambone/Football_Analytics_Final" target="_blank" rel="noopener noreferrer">https://github.com/danielgambone/Football_Analytics_Final</a></p>

            <h3>Web scraping</h3>
            <p>I scraped data from NFL.com because it is a trustworthy source and provided the correct tabular format of the data. The table was organized in the format I wanted. I used the following two websites:</p>
            <ul>
                <li><a href="https://www.nfl.com/stats/team-stats/offense/scoring/2024/reg/all" target="_blank" rel="noopener noreferrer">https://www.nfl.com/stats/team-stats/offense/scoring/2024/reg/all</a></li>
                <li><a href="https://www.nfl.com/standings/league/2024/REG" target="_blank" rel="noopener noreferrer">https://www.nfl.com/standings/league/2024/REG</a></li>
            </ul>
            <p>I used the two following AI prompts to create the web scrape code:</p>
            <ul>
                <li>"Write a Python function that uses requests and BeautifulSoup to scrape the 'Team Scoring 2024' table from this NFL page: https://www.nfl.com/stats/team-stats/offense/scoring/2024/reg/all. Create a SQLite database named NFL Stats and use the following fields to create the new table: 'Rsh_TD', 'Rec_TD', 'Tot_TD', '2-PT'. Handle missing values and strip whitespace."</li>
                <li>"Write another Python function that uses requests and Beautiful Soup to scrape the 2024 Division standings table from this NFL page: https://www.nfl.com/standings/league/2024/REG. Use the existing NFL_Stats database. When creating the new team id in this table use the team id found in the original 'Team Scoring 2024' table. This id should represent the team. Also pull in the following fields: 'NFL_Team', 'W', 'L', 'T'."</li>
            </ul>

            <h4>Example HTTP request and parse step</h4>
            <pre><code>url = "https://www.nfl.com/standings/league/2024/REG"

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'
}
response = requests.get(url, headers=headers)
response.raise_for_status()

soup = BeautifulSoup(response.content, 'html.parser')
table = soup.find('table')

headers_row = table.find('thead')
header_cells = headers_row.find_all('th')
header_names = [cell.get_text(strip=True) for cell in header_cells]

rows = table.find('tbody').find_all('tr')
standings_data = []

for row in rows:
    cells = row.find_all('td')
    if len(cells) == 0:
        continue

    team_cell = cells[0]
    team_text = team_cell.get_text(strip=True)

    words = team_text.split()
    last_word = words[-1] if words else ""

    if last_word:
        team_name = ""
        for j, char in enumerate(last_word):
            if char.isupper():
                if not team_name:
                    team_name = char
                else:
                    team_name += char
            elif char.isalpha() and team_name:
                team_name += char
            elif not char.isalpha() and team_name:
                break

        if team_name and len(team_name) > 2:
            if len(team_name) % 2 == 0:
                half_len = len(team_name) // 2
                if team_name[:half_len].lower() == team_name[half_len:].lower():
                    team_name = team_name[:half_len]
    else:
        team_name = None

    row_data = {'NFL_Team': team_name}
    standings_data.append(row_data)</code></pre>

            <h3>Database</h3>
            <p>I used the following tables and columns:</p>
            <ul>
                <li><strong>league_standings_2024</strong> - Team standings for the 2024 NFL season (Team Name, Wins, Losses, Ties)
                    <ul>
                        <li>ls.id -- auto generated primary key. Not needed in output.</li>
                        <li>ls.team_id -- Team Id used to uniquely identify each team</li>
                        <li>ls.NFL_Team -- Team name</li>
                        <li>ls.W -- Wins</li>
                        <li>ls.L -- Losses</li>
                        <li>ls.T -- Ties</li>
                    </ul>
                </li>
                <li><strong>team_scoring_2024</strong> - Team scoring statistics for the 2024 NFL season (includes Rushing TDs, Receiving TDs, Total TDs, 2 Points Conversions)
                    <ul>
                        <li>s.id AS team_id -- Team Id used to uniquely identify each team and to match with the standings table team ids</li>
                        <li>s.Team -- Team name</li>
                        <li>s.Rsh_TD -- Rushing Touchdowns</li>
                        <li>s.Rec_TD -- Receiving Touchdowns</li>
                        <li>s.Tot_TD -- Total Touchdowns</li>
                        <li>s.'2-PT' -- Successful 2-Point conversions</li>
                    </ul>
                </li>
            </ul>

            <h4>Example data from CSV file for the web app</h4>
            <pre><code>Team,Rushing_Touchdowns,Receiving_Touchdowns,Total_Touchdowns,Two_Point_Conversions,Wins,Losses,Ties
49ers,17,23,42,0,6,11,0</code></pre>

            <h4>Query used to generate CSV</h4>
            <pre><code>select NFL_Team as "Team", W as "Wins", L as "Losses", T as "Ties", Rsh_TD as "Rushing Touchdowns", Rec_TD as "Receiving Touchdowns", Tot_TD as "Total Touchdowns", "2-PT" as "Two Point Conversions"
from league_standings_2024
inner join team_scoring_2024
on league_standings_2024.team_id = team_scoring_2024.id</code></pre>

            <h3>Web Application</h3>
            <p>The user selects an NFL team to see the related data.</p>
        </section>
    </div>

    <script>
        let teamsData = [];
        let chart = null;
        let top10Data = [];
        let top10Chart = null;

        // Pie Chart - Offensive Balance
        function renderPieChart(teamData) {
            const canvas = document.getElementById('pieChart');
            const ctx = canvas.getContext('2d');
            
            canvas.width = canvas.parentElement.clientWidth - 40;
            canvas.height = 350;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2 - 20;
            const radius = Math.min(centerX, centerY) - 40;

            const rushing = teamData.rushingTouchdowns;
            const receiving = teamData.receivingTouchdowns;
            const total = rushing + receiving;

            if (total === 0) return;

            const rushingAngle = (rushing / total) * 2 * Math.PI;
            const receivingAngle = (receiving / total) * 2 * Math.PI;

            // Draw rushing slice
            ctx.beginPath();
            ctx.moveTo(centerX, centerY);
            ctx.arc(centerX, centerY, radius, 0, rushingAngle);
            ctx.closePath();
            ctx.fillStyle = '#667eea';
            ctx.fill();
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 3;
            ctx.stroke();

            // Draw receiving slice
            ctx.beginPath();
            ctx.moveTo(centerX, centerY);
            ctx.arc(centerX, centerY, radius, rushingAngle, rushingAngle + receivingAngle);
            ctx.closePath();
            ctx.fillStyle = '#f093fb';
            ctx.fill();
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 3;
            ctx.stroke();

            // Labels
            ctx.font = 'bold 16px Arial';
            ctx.fillStyle = '#fff';
            ctx.textAlign = 'center';

            const rushingLabelAngle = rushingAngle / 2;
            const rushingLabelX = centerX + Math.cos(rushingLabelAngle) * (radius * 0.6);
            const rushingLabelY = centerY + Math.sin(rushingLabelAngle) * (radius * 0.6);
            ctx.fillText(`${rushing}`, rushingLabelX, rushingLabelY);

            const receivingLabelAngle = rushingAngle + receivingAngle / 2;
            const receivingLabelX = centerX + Math.cos(receivingLabelAngle) * (radius * 0.6);
            const receivingLabelY = centerY + Math.sin(receivingLabelAngle) * (radius * 0.6);
            ctx.fillText(`${receiving}`, receivingLabelX, receivingLabelY);

            // Title
            ctx.font = 'bold 20px Arial';
            ctx.fillStyle = '#333';
            ctx.fillText(`${teamData.team} - TD Breakdown`, centerX, 30);

            // Legend
            ctx.font = '14px Arial';
            ctx.textAlign = 'left';
            ctx.fillStyle = '#667eea';
            ctx.fillRect(centerX - 150, canvas.height - 40, 20, 20);
            ctx.fillStyle = '#333';
            ctx.fillText(`Rushing TDs: ${rushing} (${(rushing/total*100).toFixed(1)}%)`, centerX - 125, canvas.height - 25);

            ctx.fillStyle = '#f093fb';
            ctx.fillRect(centerX + 30, canvas.height - 40, 20, 20);
            ctx.fillStyle = '#333';
            ctx.fillText(`Receiving TDs: ${receiving} (${(receiving/total*100).toFixed(1)}%)`, centerX + 55, canvas.height - 25);
        }

        // Radar Chart - Team Profile
        function renderRadarChart(teamData) {
            const canvas = document.getElementById('radarChart');
            const ctx = canvas.getContext('2d');
            
            canvas.width = canvas.parentElement.clientWidth - 40;
            canvas.height = 400;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = Math.min(centerX, centerY) - 80;

            // Normalize data to 0-1 scale
            const maxWins = Math.max(...teamsData.map(t => t.wins));
            const maxTDs = Math.max(...teamsData.map(t => t.totalTouchdowns));
            const maxRushTDs = Math.max(...teamsData.map(t => t.rushingTouchdowns));
            const maxRecTDs = Math.max(...teamsData.map(t => t.receivingTouchdowns));
            const max2PT = Math.max(...teamsData.map(t => t.twoPointConversions));

            const metrics = [
                { label: 'Wins', value: teamData.wins / maxWins, raw: teamData.wins },
                { label: 'Total TDs', value: teamData.totalTouchdowns / maxTDs, raw: teamData.totalTouchdowns },
                { label: 'Rushing TDs', value: teamData.rushingTouchdowns / maxRushTDs, raw: teamData.rushingTouchdowns },
                { label: 'Receiving TDs', value: teamData.receivingTouchdowns / maxRecTDs, raw: teamData.receivingTouchdowns },
                { label: '2-PT Conv', value: teamData.twoPointConversions / (max2PT || 1), raw: teamData.twoPointConversions }
            ];

            const angleStep = (2 * Math.PI) / metrics.length;

            // Draw grid circles
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;
            for (let i = 1; i <= 5; i++) {
                ctx.beginPath();
                ctx.arc(centerX, centerY, (radius / 5) * i, 0, 2 * Math.PI);
                ctx.stroke();
            }

            // Draw axes
            ctx.strokeStyle = '#ccc';
            ctx.lineWidth = 1;
            metrics.forEach((metric, i) => {
                const angle = i * angleStep - Math.PI / 2;
                const x = centerX + Math.cos(angle) * radius;
                const y = centerY + Math.sin(angle) * radius;
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.lineTo(x, y);
                ctx.stroke();

                // Labels
                ctx.font = '12px Arial';
                ctx.fillStyle = '#333';
                ctx.textAlign = 'center';
                const labelX = centerX + Math.cos(angle) * (radius + 25);
                const labelY = centerY + Math.sin(angle) * (radius + 25);
                ctx.fillText(metric.label, labelX, labelY);
                ctx.fillText(`(${metric.raw})`, labelX, labelY + 15);
            });

            // Draw data polygon
            ctx.beginPath();
            metrics.forEach((metric, i) => {
                const angle = i * angleStep - Math.PI / 2;
                const distance = metric.value * radius;
                const x = centerX + Math.cos(angle) * distance;
                const y = centerY + Math.sin(angle) * distance;
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.closePath();
            ctx.fillStyle = 'rgba(102, 126, 234, 0.3)';
            ctx.fill();
            ctx.strokeStyle = '#667eea';
            ctx.lineWidth = 2;
            ctx.stroke();

            // Draw points
            metrics.forEach((metric, i) => {
                const angle = i * angleStep - Math.PI / 2;
                const distance = metric.value * radius;
                const x = centerX + Math.cos(angle) * distance;
                const y = centerY + Math.sin(angle) * distance;
                ctx.beginPath();
                ctx.arc(x, y, 4, 0, 2 * Math.PI);
                ctx.fillStyle = '#667eea';
                ctx.fill();
            });

            // Title
            ctx.font = 'bold 18px Arial';
            ctx.fillStyle = '#333';
            ctx.textAlign = 'center';
            ctx.fillText(`${teamData.team} Performance Profile`, centerX, 25);
        }

        // Team Comparison
        function updateComparison() {
            const team1Name = document.getElementById('team1Select').value;
            const team2Name = document.getElementById('team2Select').value;

            if (!team1Name || !team2Name) return;

            const team1 = teamsData.find(t => t.team === team1Name);
            const team2 = teamsData.find(t => t.team === team2Name);

            if (!team1 || !team2) return;

            renderComparisonChart(team1, team2);
        }

        function renderComparisonChart(team1, team2) {
            const canvas = document.getElementById('comparisonChart');
            const ctx = canvas.getContext('2d');
            
            canvas.width = canvas.parentElement.clientWidth - 40;
            canvas.height = 400;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const metrics = [
                { label: 'Wins', key: 'wins' },
                { label: 'Rushing TDs', key: 'rushingTouchdowns' },
                { label: 'Receiving TDs', key: 'receivingTouchdowns' },
                { label: 'Total TDs', key: 'totalTouchdowns' },
                { label: '2-PT Conv', key: 'twoPointConversions' }
            ];

            const padding = 80;
            const chartWidth = canvas.width - padding * 2;
            const chartHeight = canvas.height - padding * 1.5;
            const groupWidth = chartWidth / metrics.length;
            const barWidth = groupWidth / 2.8;

            // Find max value for scaling
            const maxValue = Math.max(
                ...metrics.map(m => Math.max(team1[m.key], team2[m.key]))
            );

            // Title
            ctx.font = 'bold 18px Arial';
            ctx.fillStyle = '#333';
            ctx.textAlign = 'center';
            ctx.fillText(`${team1.team} vs ${team2.team}`, canvas.width / 2, 25);

            // Axes
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, canvas.height - padding);
            ctx.lineTo(canvas.width - padding, canvas.height - padding);
            ctx.stroke();

            // Draw bars
            metrics.forEach((metric, i) => {
                const baseX = padding + i * groupWidth;
                const team1Value = team1[metric.key];
                const team2Value = team2[metric.key];
                
                const team1Height = (team1Value / maxValue) * (chartHeight * 0.9);
                const team2Height = (team2Value / maxValue) * (chartHeight * 0.9);

                const team1X = baseX + groupWidth * 0.2;
                const team2X = team1X + barWidth + 8;

                const team1Y = canvas.height - padding - team1Height;
                const team2Y = canvas.height - padding - team2Height;

                // Team 1 bar
                ctx.fillStyle = '#667eea';
                ctx.fillRect(team1X, team1Y, barWidth, team1Height);
                ctx.fillStyle = '#222';
                ctx.font = '11px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(team1Value, team1X + barWidth / 2, team1Y - 6);

                // Team 2 bar
                ctx.fillStyle = '#f093fb';
                ctx.fillRect(team2X, team2Y, barWidth, team2Height);
                ctx.fillStyle = '#222';
                ctx.fillText(team2Value, team2X + barWidth / 2, team2Y - 6);

                // Metric label
                ctx.save();
                ctx.translate(baseX + groupWidth / 2, canvas.height - padding + 20);
                ctx.rotate(-Math.PI / 6);
                ctx.textAlign = 'right';
                ctx.fillStyle = '#444';
                ctx.font = '12px Arial';
                ctx.fillText(metric.label, 0, 0);
                ctx.restore();
            });

            // Y-axis labels
            ctx.fillStyle = '#666';
            ctx.font = '12px Arial';
            ctx.textAlign = 'right';
            for (let i = 0; i <= 5; i++) {
                const value = Math.round((maxValue / 5) * i);
                const y = canvas.height - padding - (chartHeight * 0.9 * i / 5);
                ctx.fillText(value, padding - 10, y + 4);
                ctx.strokeStyle = '#e0e0e0';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(canvas.width - padding, y);
                ctx.stroke();
            }

            // Legend
            ctx.font = '14px Arial';
            ctx.fillStyle = '#667eea';
            ctx.fillRect(canvas.width / 2 - 100, canvas.height - 25, 20, 15);
            ctx.fillStyle = '#333';
            ctx.textAlign = 'left';
            ctx.fillText(team1.team, canvas.width / 2 - 75, canvas.height - 13);

            ctx.fillStyle = '#f093fb';
            ctx.fillRect(canvas.width / 2 + 50, canvas.height - 25, 20, 15);
            ctx.fillStyle = '#333';
            ctx.fillText(team2.team, canvas.width / 2 + 75, canvas.height - 13);
        }

        // Scatter Plot - Wins vs TDs
        function renderScatterPlot() {
            if (!teamsData || teamsData.length === 0) return;
            
            const canvas = document.getElementById('scatterChart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            
            canvas.width = canvas.parentElement.clientWidth - 40;
            canvas.height = 450;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const padding = 70;
            const chartWidth = canvas.width - padding * 2;
            const chartHeight = canvas.height - padding * 1.5;

            const maxWins = Math.max(...teamsData.map(t => t.wins));
            const maxTDs = Math.max(...teamsData.map(t => t.totalTouchdowns));
            
            const scatterSelect = document.getElementById('scatterTeamSelect');
            const highlightTeam = scatterSelect ? scatterSelect.value : '';

            // Title
            ctx.font = 'bold 18px Arial';
            ctx.fillStyle = '#333';
            ctx.textAlign = 'center';
            ctx.fillText('League-Wide: Wins vs Total Touchdowns', canvas.width / 2, 25);

            // Axes
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, canvas.height - padding);
            ctx.lineTo(canvas.width - padding, canvas.height - padding);
            ctx.stroke();

            // Grid lines
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;
            for (let i = 0; i <= 5; i++) {
                const y = canvas.height - padding - (chartHeight * i / 5);
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(canvas.width - padding, y);
                ctx.stroke();

                const x = padding + (chartWidth * i / 5);
                ctx.beginPath();
                ctx.moveTo(x, padding);
                ctx.lineTo(x, canvas.height - padding);
                ctx.stroke();
            }

            // Plot points (non-highlighted first, then highlighted on top)
            const sortedTeams = [...teamsData].sort((a, b) => {
                if (a.team === highlightTeam) return 1;
                if (b.team === highlightTeam) return -1;
                return 0;
            });

            sortedTeams.forEach(team => {
                const x = padding + (team.wins / maxWins) * chartWidth;
                const y = canvas.height - padding - (team.totalTouchdowns / maxTDs) * chartHeight;
                const isHighlighted = team.team === highlightTeam;

                ctx.beginPath();
                ctx.arc(x, y, isHighlighted ? 9 : 6, 0, 2 * Math.PI);
                
                if (isHighlighted) {
                    ctx.fillStyle = '#FFD700'; // Gold/Yellow
                    ctx.fill();
                    ctx.strokeStyle = '#FF8C00'; // Dark orange border
                    ctx.lineWidth = 3;
                    ctx.stroke();
                    
                    // Add glow effect
                    ctx.beginPath();
                    ctx.arc(x, y, 13, 0, 2 * Math.PI);
                    ctx.strokeStyle = 'rgba(255, 215, 0, 0.3)';
                    ctx.lineWidth = 6;
                    ctx.stroke();
                } else {
                    ctx.fillStyle = 'rgba(102, 126, 234, 0.7)';
                    ctx.fill();
                    ctx.strokeStyle = '#667eea';
                    ctx.lineWidth = 2;
                    ctx.stroke();
                }

                // Team label
                ctx.font = isHighlighted ? 'bold 11px Arial' : '10px Arial';
                ctx.fillStyle = isHighlighted ? '#FF8C00' : '#333';
                ctx.textAlign = 'center';
                ctx.fillText(team.team, x, y - (isHighlighted ? 14 : 10));
            });

            // Axis labels
            ctx.font = '14px Arial';
            ctx.fillStyle = '#333';
            ctx.textAlign = 'center';
            ctx.fillText('Wins ‚Üí', canvas.width / 2, canvas.height - 15);
            
            ctx.save();
            ctx.translate(20, canvas.height / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('Total Touchdowns ‚Üí', 0, 0);
            ctx.restore();

            // X-axis values
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            for (let i = 0; i <= 5; i++) {
                const value = Math.round((maxWins / 5) * i);
                const x = padding + (chartWidth * i / 5);
                ctx.fillText(value, x, canvas.height - padding + 20);
            }

            // Y-axis values
            ctx.textAlign = 'right';
            for (let i = 0; i <= 5; i++) {
                const value = Math.round((maxTDs / 5) * i);
                const y = canvas.height - padding - (chartHeight * i / 5);
                ctx.fillText(value, padding - 10, y + 4);
            }
        }

        // Render grouped bars for Top 10 teams (Wins and Total TDs with ranks)
        function renderTop10Chart() {
            if (!top10Data.length) return;
            const canvas = document.getElementById('top10Chart');
            const ctx = canvas.getContext('2d');

            canvas.width = canvas.parentElement.clientWidth - 40;
            canvas.height = 360;

            const ordered = [...top10Data].sort((a, b) => {
                if (a.winRank === b.winRank) return a.tdRank - b.tdRank;
                return a.winRank - b.winRank;
            });

            const padding = 70;
            const chartWidth = canvas.width - padding * 2;
            const chartHeight = canvas.height - padding * 1.3;
            const groupWidth = chartWidth / ordered.length;
            const barWidth = groupWidth / 2.4;
            const maxValue = Math.max(
                ...ordered.map(t => Math.max(t.wins, t.totalTouchdowns))
            );

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // axes
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(padding, padding * 0.6);
            ctx.lineTo(padding, canvas.height - padding);
            ctx.lineTo(canvas.width - padding, canvas.height - padding);
            ctx.stroke();

            ordered.forEach((team, i) => {
                const baseX = padding + i * groupWidth;
                const winsHeight = (team.wins / maxValue) * (chartHeight * 0.9);
                const tdHeight = (team.totalTouchdowns / maxValue) * (chartHeight * 0.9);
                const winsX = baseX + groupWidth * 0.15;
                const tdX = winsX + barWidth + 6;
                const winsY = canvas.height - padding - winsHeight;
                const tdY = canvas.height - padding - tdHeight;

                // Wins bar
                ctx.fillStyle = '#667eea';
                ctx.fillRect(winsX, winsY, barWidth, winsHeight);
                ctx.fillStyle = '#1f1f1f';
                ctx.font = '11px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(`${team.wins} (R${team.winRank})`, winsX + barWidth / 2, winsY - 6);

                // Total TD bar
                ctx.fillStyle = '#f093fb';
                ctx.fillRect(tdX, tdY, barWidth, tdHeight);
                ctx.fillStyle = '#1f1f1f';
                ctx.fillText(`${team.totalTouchdowns} (R${team.tdRank})`, tdX + barWidth / 2, tdY - 6);

                // Team label
                ctx.save();
                ctx.translate(baseX + groupWidth / 2, canvas.height - padding + 22);
                ctx.rotate(-Math.PI / 6);
                ctx.textAlign = 'right';
                ctx.fillStyle = '#444';
                ctx.font = '12px Arial';
                ctx.fillText(team.team, 0, 0);
                ctx.restore();
            });

            // y-axis labels + grid
            ctx.fillStyle = '#666';
            ctx.font = '12px Arial';
            ctx.textAlign = 'right';
            for (let i = 0; i <= 5; i++) {
                const value = Math.round((maxValue / 5) * i);
                const y = canvas.height - padding - (chartHeight * 0.9 * i / 5);
                ctx.fillText(value, padding - 10, y + 4);
                ctx.strokeStyle = '#e0e0e0';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(canvas.width - padding, y);
                ctx.stroke();
            }
        }

        // Load and parse CSV data
        async function loadCSVData() {
            try {
                const response = await fetch('2024_Team_Scoring_Standings.csv');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const csvText = await response.text();
                
                if (!csvText || csvText.trim().length === 0) {
                    throw new Error('CSV file is empty');
                }
                
                const lines = csvText.trim().split('\n');
                const headers = lines[0].split(',');
                
                teamsData = lines.slice(1).map(line => {
                    const values = line.split(',');
                    return {
                        team: values[0],
                        rushingTouchdowns: parseInt(values[1]),
                        receivingTouchdowns: parseInt(values[2]),
                        totalTouchdowns: parseInt(values[3]),
                        twoPointConversions: parseInt(values[4]),
                        wins: parseInt(values[5]),
                        losses: parseInt(values[6]),
                        ties: parseInt(values[7])
                    };
                });

                populateTeamDropdown();
                // kick off secondary visuals once base data is ready
                if (top10Data.length) renderTop10Chart();
                renderScatterPlot();
            } catch (error) {
                console.error('Error loading CSV:', error);
                const chartContainers = document.querySelectorAll('.chart-container');
                if (chartContainers.length > 0) {
                    chartContainers[0].innerHTML = 
                        '<div class="error">Error loading data: ' + error.message + '<br>Please ensure 2024_Team_Scoring_Standings.csv is in the same directory.</div>';
                }
            }
        }

        // Load Top10Teams.csv for aggregated ranked view
        async function loadTop10Data() {
            try {
                const response = await fetch('Top10Teams.csv');
                const csvText = await response.text();

                const lines = csvText.trim().split('\n');
                const rows = lines.slice(1); // skip header
                top10Data = rows.map(line => {
                    const [team_id, Team, Wins, WinRank, TotalTDs, TDRank] = line.split(',');
                    return {
                        teamId: parseInt(team_id),
                        team: Team,
                        wins: parseInt(Wins),
                        winRank: parseInt(WinRank),
                        totalTouchdowns: parseInt(TotalTDs),
                        tdRank: parseInt(TDRank)
                    };
                });

                renderTop10Chart();
            } catch (err) {
                console.error('Error loading Top10Teams.csv', err);
            }
        }

        // Populate the team dropdown
        function populateTeamDropdown() {
            const select = document.getElementById('teamSelect');
            const team1Select = document.getElementById('team1Select');
            const team2Select = document.getElementById('team2Select');
            const scatterTeamSelect = document.getElementById('scatterTeamSelect');
            
            teamsData.forEach(team => {
                const option = document.createElement('option');
                option.value = team.team;
                option.textContent = team.team;
                select.appendChild(option);

                // Add to comparison dropdowns
                const option1 = option.cloneNode(true);
                const option2 = option.cloneNode(true);
                const option3 = option.cloneNode(true);
                team1Select.appendChild(option1);
                team2Select.appendChild(option2);
                scatterTeamSelect.appendChild(option3);
            });

            select.addEventListener('change', (e) => {
                if (e.target.value) {
                    displayTeamData(e.target.value);
                }
            });

            // Team comparison listeners
            team1Select.addEventListener('change', updateComparison);
            team2Select.addEventListener('change', updateComparison);
            
            // Scatter plot highlight listener
            scatterTeamSelect.addEventListener('change', renderScatterPlot);
        }

        // Display selected team data
        function displayTeamData(teamName) {
            const teamData = teamsData.find(t => t.team === teamName);
            if (!teamData) return;

            // Update chart
            updateChart(teamData);

            // Update stats summary
            updateStatsSummary(teamData);

            // Show and update pie chart
            document.getElementById('offensiveBalanceSection').style.display = 'block';
            renderPieChart(teamData);

            // Show and update radar chart
            document.getElementById('radarSection').style.display = 'block';
            renderRadarChart(teamData);
        }

        // Create/Update chart
        function updateChart(teamData) {
            const canvas = document.getElementById('scoringChart');
            const ctx = canvas.getContext('2d');

            // Clear previous chart
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Set canvas size
            canvas.width = canvas.parentElement.clientWidth - 40;
            canvas.height = 450;

            const data = [
                { label: 'Rushing TDs', value: teamData.rushingTouchdowns, color: '#667eea' },
                { label: 'Receiving TDs', value: teamData.receivingTouchdowns, color: '#764ba2' },
                { label: 'Total TDs', value: teamData.totalTouchdowns, color: '#f093fb' },
                { label: '2-PT Conversions', value: teamData.twoPointConversions, color: '#4facfe' }
            ];

            drawBarChart(ctx, canvas, data, teamData.team);
        }

        // Draw bar chart
        function drawBarChart(ctx, canvas, data, teamName) {
            const padding = 60;
            const chartWidth = canvas.width - padding * 2;
            const chartHeight = canvas.height - padding * 2;
            const barWidth = chartWidth / (data.length * 2);
            const maxValue = Math.max(...data.map(d => d.value));

            // Draw title
            ctx.font = 'bold 24px Arial';
            ctx.fillStyle = '#333';
            ctx.textAlign = 'center';
            ctx.fillText(`${teamName} - Scoring Statistics`, canvas.width / 2, 30);

            // Draw axes
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, canvas.height - padding);
            ctx.lineTo(canvas.width - padding, canvas.height - padding);
            ctx.stroke();

            // Draw bars
            data.forEach((item, index) => {
                const barHeight = (item.value / maxValue) * chartHeight * 0.9;
                const x = padding + (index * 2 + 0.5) * barWidth;
                const y = canvas.height - padding - barHeight;

                // Draw bar
                ctx.fillStyle = item.color;
                ctx.fillRect(x, y, barWidth * 1.5, barHeight);

                // Draw value on top of bar
                ctx.font = 'bold 16px Arial';
                ctx.fillStyle = '#333';
                ctx.textAlign = 'center';
                ctx.fillText(item.value, x + barWidth * 0.75, y - 5);

                // Draw label
                ctx.font = '12px Arial';
                ctx.fillStyle = '#666';
                ctx.save();
                ctx.translate(x + barWidth * 0.75, canvas.height - padding + 15);
                ctx.rotate(-Math.PI / 6);
                ctx.textAlign = 'right';
                ctx.fillText(item.label, 0, 0);
                ctx.restore();
            });

            // Draw Y-axis labels
            ctx.font = '12px Arial';
            ctx.fillStyle = '#666';
            ctx.textAlign = 'right';
            for (let i = 0; i <= 5; i++) {
                const value = Math.round((maxValue / 5) * i);
                const y = canvas.height - padding - (chartHeight * 0.9 * i / 5);
                ctx.fillText(value, padding - 10, y + 4);
                
                // Grid lines
                ctx.strokeStyle = '#e0e0e0';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(canvas.width - padding, y);
                ctx.stroke();
            }
        }

        // Update stats summary cards
        function updateStatsSummary(teamData) {
            const summaryDiv = document.getElementById('statsSummary');
            summaryDiv.innerHTML = `
                <div class="stat-card">
                    <h3>Rushing Touchdowns</h3>
                    <div class="value">${teamData.rushingTouchdowns}</div>
                </div>
                <div class="stat-card">
                    <h3>Receiving Touchdowns</h3>
                    <div class="value">${teamData.receivingTouchdowns}</div>
                </div>
                <div class="stat-card">
                    <h3>Total Touchdowns</h3>
                    <div class="value">${teamData.totalTouchdowns}</div>
                </div>
                <div class="stat-card">
                    <h3>Two Point Conversions</h3>
                    <div class="value">${teamData.twoPointConversions}</div>
                </div>
                <div class="stat-card">
                    <h3>Season Record</h3>
                    <div class="value" style="font-size: 1.8em;">${teamData.wins}-${teamData.losses}-${teamData.ties}</div>
                </div>
            `;
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', () => {
            loadCSVData();
            loadTop10Data();
        });

        // Handle window resize
        window.addEventListener('resize', () => {
            const select = document.getElementById('teamSelect');
            if (select.value) {
                displayTeamData(select.value);
            }
            if (top10Data.length) renderTop10Chart();
            updateComparison();
            renderScatterPlot();
        });
    </script>
</body>
</html>
            const canvas = document.getElementById('pieChart');
            const ctx = canvas.getContext('2d');
            
            canvas.width = canvas.parentElement.clientWidth - 40;
            canvas.height = 350;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2 - 20;
            const radius = Math.min(centerX, centerY) - 40;

            const rushing = teamData.rushingTouchdowns;
            const receiving = teamData.receivingTouchdowns;
            const total = rushing + receiving;

            if (total === 0) return;

            const rushingAngle = (rushing / total) * 2 * Math.PI;
            const receivingAngle = (receiving / total) * 2 * Math.PI;

            // Draw rushing slice
            ctx.beginPath();
            ctx.moveTo(centerX, centerY);
            ctx.arc(centerX, centerY, radius, 0, rushingAngle);
            ctx.closePath();
            ctx.fillStyle = '#667eea';
            ctx.fill();
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 3;
            ctx.stroke();

            // Draw receiving slice
            ctx.beginPath();
            ctx.moveTo(centerX, centerY);
            ctx.arc(centerX, centerY, radius, rushingAngle, rushingAngle + receivingAngle);
            ctx.closePath();
            ctx.fillStyle = '#f093fb';
            ctx.fill();
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 3;
            ctx.stroke();

            // Labels
            ctx.font = 'bold 16px Arial';
            ctx.fillStyle = '#fff';
            ctx.textAlign = 'center';

            const rushingLabelAngle = rushingAngle / 2;
            const rushingLabelX = centerX + Math.cos(rushingLabelAngle) * (radius * 0.6);
            const rushingLabelY = centerY + Math.sin(rushingLabelAngle) * (radius * 0.6);
            ctx.fillText(`${rushing}`, rushingLabelX, rushingLabelY);

            const receivingLabelAngle = rushingAngle + receivingAngle / 2;
            const receivingLabelX = centerX + Math.cos(receivingLabelAngle) * (radius * 0.6);
            const receivingLabelY = centerY + Math.sin(receivingLabelAngle) * (radius * 0.6);
            ctx.fillText(`${receiving}`, receivingLabelX, receivingLabelY);

            // Title
            ctx.font = 'bold 20px Arial';
            ctx.fillStyle = '#333';
            ctx.fillText(`${teamData.team} - TD Breakdown`, centerX, 30);

            // Legend
            ctx.font = '14px Arial';
            ctx.textAlign = 'left';
            ctx.fillStyle = '#667eea';
            ctx.fillRect(centerX - 150, canvas.height - 40, 20, 20);
            ctx.fillStyle = '#333';
            ctx.fillText(`Rushing TDs: ${rushing} (${(rushing/total*100).toFixed(1)}%)`, centerX - 125, canvas.height - 25);

            ctx.fillStyle = '#f093fb';
            ctx.fillRect(centerX + 30, canvas.height - 40, 20, 20);
            ctx.fillStyle = '#333';
            ctx.fillText(`Receiving TDs: ${receiving} (${(receiving/total*100).toFixed(1)}%)`, centerX + 55, canvas.height - 25);
        }

        // Radar Chart - Team Profile
        function renderRadarChart(teamData) {
            const canvas = document.getElementById('radarChart');
            const ctx = canvas.getContext('2d');
            
            canvas.width = canvas.parentElement.clientWidth - 40;
            canvas.height = 400;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = Math.min(centerX, centerY) - 80;

            // Normalize data to 0-1 scale
            const maxWins = Math.max(...teamsData.map(t => t.wins));
            const maxTDs = Math.max(...teamsData.map(t => t.totalTouchdowns));
            const maxRushTDs = Math.max(...teamsData.map(t => t.rushingTouchdowns));
            const maxRecTDs = Math.max(...teamsData.map(t => t.receivingTouchdowns));
            const max2PT = Math.max(...teamsData.map(t => t.twoPointConversions));

            const metrics = [
                { label: 'Wins', value: teamData.wins / maxWins, raw: teamData.wins },
                { label: 'Total TDs', value: teamData.totalTouchdowns / maxTDs, raw: teamData.totalTouchdowns },
                { label: 'Rushing TDs', value: teamData.rushingTouchdowns / maxRushTDs, raw: teamData.rushingTouchdowns },
                { label: 'Receiving TDs', value: teamData.receivingTouchdowns / maxRecTDs, raw: teamData.receivingTouchdowns },
                { label: '2-PT Conv', value: teamData.twoPointConversions / (max2PT || 1), raw: teamData.twoPointConversions }
            ];

            const angleStep = (2 * Math.PI) / metrics.length;

            // Draw grid circles
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;
            for (let i = 1; i <= 5; i++) {
                ctx.beginPath();
                ctx.arc(centerX, centerY, (radius / 5) * i, 0, 2 * Math.PI);
                ctx.stroke();
            }

            // Draw axes
            ctx.strokeStyle = '#ccc';
            ctx.lineWidth = 1;
            metrics.forEach((metric, i) => {
                const angle = i * angleStep - Math.PI / 2;
                const x = centerX + Math.cos(angle) * radius;
                const y = centerY + Math.sin(angle) * radius;
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.lineTo(x, y);
                ctx.stroke();

                // Labels
                ctx.font = '12px Arial';
                ctx.fillStyle = '#333';
                ctx.textAlign = 'center';
                const labelX = centerX + Math.cos(angle) * (radius + 25);
                const labelY = centerY + Math.sin(angle) * (radius + 25);
                ctx.fillText(metric.label, labelX, labelY);
                ctx.fillText(`(${metric.raw})`, labelX, labelY + 15);
            });

            // Draw data polygon
            ctx.beginPath();
            metrics.forEach((metric, i) => {
                const angle = i * angleStep - Math.PI / 2;
                const distance = metric.value * radius;
                const x = centerX + Math.cos(angle) * distance;
                const y = centerY + Math.sin(angle) * distance;
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.closePath();
            ctx.fillStyle = 'rgba(102, 126, 234, 0.3)';
            ctx.fill();
            ctx.strokeStyle = '#667eea';
            ctx.lineWidth = 2;
            ctx.stroke();

            // Draw points
            metrics.forEach((metric, i) => {
                const angle = i * angleStep - Math.PI / 2;
                const distance = metric.value * radius;
                const x = centerX + Math.cos(angle) * distance;
                const y = centerY + Math.sin(angle) * distance;
                ctx.beginPath();
                ctx.arc(x, y, 4, 0, 2 * Math.PI);
                ctx.fillStyle = '#667eea';
                ctx.fill();
            });

            // Title
            ctx.font = 'bold 18px Arial';
            ctx.fillStyle = '#333';
            ctx.textAlign = 'center';
            ctx.fillText(`${teamData.team} Performance Profile`, centerX, 25);
        }

        // Team Comparison
        function updateComparison() {
            const team1Name = document.getElementById('team1Select').value;
            const team2Name = document.getElementById('team2Select').value;

            if (!team1Name || !team2Name) return;

            const team1 = teamsData.find(t => t.team === team1Name);
            const team2 = teamsData.find(t => t.team === team2Name);

            if (!team1 || !team2) return;

            renderComparisonChart(team1, team2);
        }

        function renderComparisonChart(team1, team2) {
            const canvas = document.getElementById('comparisonChart');
            const ctx = canvas.getContext('2d');
            
            canvas.width = canvas.parentElement.clientWidth - 40;
            canvas.height = 400;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const metrics = [
                { label: 'Wins', key: 'wins' },
                { label: 'Rushing TDs', key: 'rushingTouchdowns' },
                { label: 'Receiving TDs', key: 'receivingTouchdowns' },
                { label: 'Total TDs', key: 'totalTouchdowns' },
                { label: '2-PT Conv', key: 'twoPointConversions' }
            ];

            const padding = 80;
            const chartWidth = canvas.width - padding * 2;
            const chartHeight = canvas.height - padding * 1.5;
            const groupWidth = chartWidth / metrics.length;
            const barWidth = groupWidth / 2.8;

            // Find max value for scaling
            const maxValue = Math.max(
                ...metrics.map(m => Math.max(team1[m.key], team2[m.key]))
            );

            // Title
            ctx.font = 'bold 18px Arial';
            ctx.fillStyle = '#333';
            ctx.textAlign = 'center';
            ctx.fillText(`${team1.team} vs ${team2.team}`, canvas.width / 2, 25);

            // Axes
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, canvas.height - padding);
            ctx.lineTo(canvas.width - padding, canvas.height - padding);
            ctx.stroke();

            // Draw bars
            metrics.forEach((metric, i) => {
                const baseX = padding + i * groupWidth;
                const team1Value = team1[metric.key];
                const team2Value = team2[metric.key];
                
                const team1Height = (team1Value / maxValue) * (chartHeight * 0.9);
                const team2Height = (team2Value / maxValue) * (chartHeight * 0.9);

                const team1X = baseX + groupWidth * 0.2;
                const team2X = team1X + barWidth + 8;

                const team1Y = canvas.height - padding - team1Height;
                const team2Y = canvas.height - padding - team2Height;

                // Team 1 bar
                ctx.fillStyle = '#667eea';
                ctx.fillRect(team1X, team1Y, barWidth, team1Height);
                ctx.fillStyle = '#222';
                ctx.font = '11px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(team1Value, team1X + barWidth / 2, team1Y - 6);

                // Team 2 bar
                ctx.fillStyle = '#f093fb';
                ctx.fillRect(team2X, team2Y, barWidth, team2Height);
                ctx.fillStyle = '#222';
                ctx.fillText(team2Value, team2X + barWidth / 2, team2Y - 6);

                // Metric label
                ctx.save();
                ctx.translate(baseX + groupWidth / 2, canvas.height - padding + 20);
                ctx.rotate(-Math.PI / 6);
                ctx.textAlign = 'right';
                ctx.fillStyle = '#444';
                ctx.font = '12px Arial';
                ctx.fillText(metric.label, 0, 0);
                ctx.restore();
            });

            // Y-axis labels
            ctx.fillStyle = '#666';
            ctx.font = '12px Arial';
            ctx.textAlign = 'right';
            for (let i = 0; i <= 5; i++) {
                const value = Math.round((maxValue / 5) * i);
                const y = canvas.height - padding - (chartHeight * 0.9 * i / 5);
                ctx.fillText(value, padding - 10, y + 4);
                
                ctx.strokeStyle = '#e0e0e0';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(canvas.width - padding, y);
                ctx.stroke();
            }

            // Legend
            ctx.font = '14px Arial';
            ctx.fillStyle = '#667eea';
            ctx.fillRect(canvas.width / 2 - 100, canvas.height - 25, 20, 15);
            ctx.fillStyle = '#333';
            ctx.textAlign = 'left';
            ctx.fillText(team1.team, canvas.width / 2 - 75, canvas.height - 13);

        // Scatter Plot - Wins vs TDs
        function renderScatterPlot() {
            if (!teamsData || teamsData.length === 0) return;
            
            const canvas = document.getElementById('scatterChart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            
            canvas.width = canvas.parentElement.clientWidth - 40;
            canvas.height = 450;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const padding = 70;
            const chartWidth = canvas.width - padding * 2;
            const chartHeight = canvas.height - padding * 1.5;

            const maxWins = Math.max(...teamsData.map(t => t.wins));
            const maxTDs = Math.max(...teamsData.map(t => t.totalTouchdowns));
            
            const scatterSelect = document.getElementById('scatterTeamSelect');
            const highlightTeam = scatterSelect ? scatterSelect.value : '';

            // Title
            ctx.font = 'bold 18px Arial';
            ctx.fillStyle = '#333';
            ctx.textAlign = 'center';
            ctx.fillText('League-Wide: Wins vs Total Touchdowns', canvas.width / 2, 25);

            // Axes
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, canvas.height - padding);
            ctx.lineTo(canvas.width - padding, canvas.height - padding);
            ctx.stroke();

            // Grid lines
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;
            for (let i = 0; i <= 5; i++) {
                const y = canvas.height - padding - (chartHeight * i / 5);
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(canvas.width - padding, y);
                ctx.stroke();

                const x = padding + (chartWidth * i / 5);
                ctx.beginPath();
                ctx.moveTo(x, padding);
                ctx.lineTo(x, canvas.height - padding);
                ctx.stroke();
            }

            // Plot points (non-highlighted first, then highlighted on top)
            const sortedTeams = [...teamsData].sort((a, b) => {
                if (a.team === highlightTeam) return 1;
                if (b.team === highlightTeam) return -1;
                return 0;
            });

            sortedTeams.forEach(team => {
                const x = padding + (team.wins / maxWins) * chartWidth;
                const y = canvas.height - padding - (team.totalTouchdowns / maxTDs) * chartHeight;
                const isHighlighted = team.team === highlightTeam;

                ctx.beginPath();
                ctx.arc(x, y, isHighlighted ? 9 : 6, 0, 2 * Math.PI);
                
                if (isHighlighted) {
                    ctx.fillStyle = '#FFD700'; // Gold/Yellow
                    ctx.fill();
                    ctx.strokeStyle = '#FF8C00'; // Dark orange border
                    ctx.lineWidth = 3;
                    ctx.stroke();
                    
                    // Add glow effect
                    ctx.beginPath();
                    ctx.arc(x, y, 13, 0, 2 * Math.PI);
                    ctx.strokeStyle = 'rgba(255, 215, 0, 0.3)';
                    ctx.lineWidth = 6;
                    ctx.stroke();
                } else {
                    ctx.fillStyle = 'rgba(102, 126, 234, 0.7)';
                    ctx.fill();
                    ctx.strokeStyle = '#667eea';
                    ctx.lineWidth = 2;
                    ctx.stroke();
                }

                // Team label
                ctx.font = isHighlighted ? 'bold 11px Arial' : '10px Arial';
                ctx.fillStyle = isHighlighted ? '#FF8C00' : '#333';
                ctx.textAlign = 'center';
                ctx.fillText(team.team, x, y - (isHighlighted ? 14 : 10));
            });

            // Axis labels
            ctx.font = '14px Arial';
            ctx.fillStyle = '#333';
            ctx.textAlign = 'center';
            ctx.fillText('Wins ‚Üí', canvas.width / 2, canvas.height - 15);
            
            ctx.save();
            ctx.translate(20, canvas.height / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('Total Touchdowns ‚Üí', 0, 0);
            ctx.restore();

            // X-axis values
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            for (let i = 0; i <= 5; i++) {
                const value = Math.round((maxWins / 5) * i);
                const x = padding + (chartWidth * i / 5);
                ctx.fillText(value, x, canvas.height - padding + 20);
            }

            // Y-axis values
            ctx.textAlign = 'right';
            for (let i = 0; i <= 5; i++) {
                const value = Math.round((maxTDs / 5) * i);
                const y = canvas.height - padding - (chartHeight * i / 5);
                ctx.fillText(value, padding - 10, y + 4);
            }
        }

        // Render grouped bars for Top 10 teams (Wins and Total TDs with ranks)
        function renderTop10Chart() {
            if (!top10Data.length) return;
            const canvas = document.getElementById('top10Chart');
            const ctx = canvas.getContext('2d');

            canvas.width = canvas.parentElement.clientWidth - 40;
            canvas.height = 360;

            const ordered = [...top10Data].sort((a, b) => {
                if (a.winRank === b.winRank) return a.tdRank - b.tdRank;
                return a.winRank - b.winRank;
            });

            const padding = 70;
            const chartWidth = canvas.width - padding * 2;
            const chartHeight = canvas.height - padding * 1.3;
            const groupWidth = chartWidth / ordered.length;
            const barWidth = groupWidth / 2.4;
            const maxValue = Math.max(
                ...ordered.map(t => Math.max(t.wins, t.totalTouchdowns))
            );

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // axes
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(padding, padding * 0.6);
            ctx.lineTo(padding, canvas.height - padding);
            ctx.lineTo(canvas.width - padding, canvas.height - padding);
            ctx.stroke();

            ordered.forEach((team, i) => {
                const baseX = padding + i * groupWidth;
                const winsHeight = (team.wins / maxValue) * (chartHeight * 0.9);
                const tdHeight = (team.totalTouchdowns / maxValue) * (chartHeight * 0.9);
                const winsX = baseX + groupWidth * 0.15;
                const tdX = winsX + barWidth + 6;
                const winsY = canvas.height - padding - winsHeight;
                const tdY = canvas.height - padding - tdHeight;

                // Wins bar
                ctx.fillStyle = '#667eea';
                ctx.fillRect(winsX, winsY, barWidth, winsHeight);
                ctx.fillStyle = '#1f1f1f';
                ctx.font = '11px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(`${team.wins} (R${team.winRank})`, winsX + barWidth / 2, winsY - 6);

                // Total TD bar
                ctx.fillStyle = '#f093fb';
                ctx.fillRect(tdX, tdY, barWidth, tdHeight);
                ctx.fillStyle = '#1f1f1f';
                ctx.fillText(`${team.totalTouchdowns} (R${team.tdRank})`, tdX + barWidth / 2, tdY - 6);

                // Team label
                ctx.save();
                ctx.translate(baseX + groupWidth / 2, canvas.height - padding + 22);
                ctx.rotate(-Math.PI / 6);
                ctx.textAlign = 'right';
                ctx.fillStyle = '#444';
                ctx.font = '12px Arial';
                ctx.fillText(team.team, 0, 0);
                ctx.restore();
            });

            // y-axis labels + grid
            ctx.fillStyle = '#666';
            ctx.font = '12px Arial';
            ctx.textAlign = 'right';
            for (let i = 0; i <= 5; i++) {
                const value = Math.round((maxValue / 5) * i);
                const y = canvas.height - padding - (chartHeight * 0.9 * i / 5);
                ctx.fillText(value, padding - 10, y + 4);
                ctx.strokeStyle = '#e0e0e0';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(canvas.width - padding, y);
                ctx.stroke();
            }
        }
    </script>
</body>
</html>
